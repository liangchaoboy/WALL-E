# Google Maps 国际路线支持

## 🌍 问题说明

**问题：** "从南京到东京" 无法正常工作

**原因：** 
- 东京是日本城市，不在中国境内
- 百度地图和高德地图的路线规划 API 仅支持中国国内路线
- 无法规划跨国路线（需要飞机、船舶等交通方式）

## ✅ 解决方案

现已添加 **Google Maps** 支持，可用于国际路线规划！

### 新增功能

1. ✅ Google Maps 路线规划
2. ✅ 支持国际路线（如：南京 → 东京）
3. ✅ 智能选择交通方式（公交、驾车、步行、骑行）
4. ✅ 全球地点搜索

## 📋 使用方法

### 方式 1：在 Claude Desktop 中明确指定地图

**国际路线（推荐使用 Google Maps）：**
```
使用 Google Maps 从南京到东京
使用谷歌地图从北京到纽约
使用 Google Maps 从上海到首尔
```

**国内路线（百度/高德更准确）：**
```
从北京到上海
使用百度地图从杭州到苏州
使用高德地图从广州到深圳
```

### 方式 2：让 AI 自动选择

Claude 会根据起点和终点智能选择地图服务：
- 国内路线 → 默认使用百度地图
- 国际路线 → AI 可能建议使用 Google Maps

## 🗺️ 支持的地图服务

| 地图服务 | 代码 | 适用场景 | 示例 |
|---------|------|---------|------|
| 百度地图 | `baidu` | 中国国内路线 | 北京 → 上海 |
| 高德地图 | `amap` | 中国国内路线 | 杭州 → 苏州 |
| Google Maps | `google` | 国际路线、全球导航 | 南京 → 东京 |

## 🧪 测试示例

### 国内路线
```
从北京到上海
✅ 使用百度地图，正常工作
```

### 跨国路线
```
从南京到东京
❌ 百度地图：无法规划（不支持国际路线）
✅ Google Maps：正常工作
```

**正确用法：**
```
使用 Google Maps 从南京到东京
```

## 🔧 技术实现

### 生成的 URL 对比

**百度地图（国内）：**
```
http://api.map.baidu.com/direction?
  origin=北京&
  destination=上海&
  mode=transit&
  region=上海&
  output=html
```

**Google Maps（国际）：**
```
https://www.google.com/maps/dir/?
  api=1&
  origin=南京&
  destination=东京&
  travelmode=transit
```

### 交通方式参数

Google Maps 支持的 `travelmode`：
- `transit` - 公共交通（默认）
- `driving` - 驾车
- `walking` - 步行
- `bicycling` - 骑行

## 📊 路线规划对比

| 路线类型 | 百度地图 | 高德地图 | Google Maps |
|---------|---------|---------|-------------|
| 中国国内城际 | ✅ 优秀 | ✅ 优秀 | ⚠️ 一般 |
| 中国本地导航 | ✅ 精确 | ✅ 精确 | ⚠️ 较差 |
| 亚洲跨国 | ❌ 不支持 | ❌ 不支持 | ✅ 支持 |
| 全球路线 | ❌ 不支持 | ❌ 不支持 | ✅ 支持 |

## 🚀 应用更新

已编译新版本，**需要重启 Claude Desktop** 才能使用 Google Maps 功能：

```bash
# 1. 检查版本
/Users/sanmu/eva/qwall2/check_version.sh

# 2. 如果进程时间早于编译时间，重启 Claude
killall Claude
open -a Claude

# 3. 或使用自动脚本
/Users/sanmu/eva/qwall2/restart_claude.sh
```

## 💡 使用建议

### 国内出行
- **首选：** 百度地图或高德地图
- **原因：** 地图数据更详细，POI 更准确，实时路况更新快

### 国际出行
- **首选：** Google Maps
- **原因：** 全球覆盖，支持多种交通方式，航班/火车信息丰富

### 示例场景

**✅ 推荐用法：**
```
# 国内旅行
从杭州到黄山  （自动使用百度地图）

# 国际旅行
使用 Google Maps 从上海到东京

# 周边游
从深圳到香港  （可用百度/高德）
使用 Google Maps 从深圳到香港  （推荐，跨境更准）
```

**❌ 不推荐：**
```
# 用百度地图规划国际路线（会失败）
从北京到巴黎

# 应该这样：
使用 Google Maps 从北京到巴黎
```

## 🔍 故障排除

### 问题 1：Google Maps 不工作

**检查清单：**
1. ✅ 已重启 Claude Desktop
2. ✅ 程序版本是最新的
3. ✅ 明确指定了 "使用 Google Maps"

**验证命令：**
```bash
# 检查是否包含 Google Maps 支持
grep -r "Google Maps" /Users/sanmu/eva/qwall2/main.go
```

### 问题 2：国际路线仍然失败

**可能原因：**
- 地点名称拼写错误
- 地点不存在或无法识别
- 网络问题（Google Maps 可能需要特殊网络）

**解决方法：**
```
# 使用英文地名
使用 Google Maps 从 Nanjing 到 Tokyo

# 使用更明确的地址
使用 Google Maps 从南京禄口机场到东京成田机场
```

## 📝 更新日志

**2025-10-24 - v1.2**
- ✅ 新增 Google Maps 支持
- ✅ 支持国际路线规划
- ✅ 添加地图服务智能选择建议
- ✅ 更新工具描述，引导用户正确使用
- ✅ 新增 27 个测试用例，全部通过

## 🎉 总结

现在可以使用三种地图服务：
1. **百度地图** - 国内城际导航
2. **高德地图** - 国内精细导航
3. **Google Maps** - 国际/全球导航

**请重启 Claude Desktop 后测试：**
```
使用 Google Maps 从南京到东京
```

应该能正常打开 Google Maps 并显示路线规划了！🌏
