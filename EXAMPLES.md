# 使用示例

本文档提供了 QWall2 地图导航 MCP 服务器的详细使用示例。

## 前置准备

1. 确保已经编译好项目：
   ```bash
   make build
   # 或
   go build -o qwall2-mcp main.go
   ```

2. 已经在 Claude Desktop 中配置好 MCP 服务器（参见 CLAUDE_CONFIG.md）

## 基础示例

### 示例 1: 简单的城市间导航

**用户输入：**
```
从北京到上海
```

**AI 处理流程：**
1. Claude 识别这是导航需求
2. 自动调用 `parse_navigation_intent` 工具
3. 提取出起点"北京"和终点"上海"
4. 调用 `navigate_map` 工具
5. 在浏览器中打开百度地图，显示从北京到上海的导航路线

### 示例 2: 具体地点导航

**用户输入：**
```
帮我从北京天安门到上海东方明珠导航
```

**AI 响应：**
- 解析出：起点=北京天安门，终点=上海东方明珠
- 打开百度地图并显示详细路线
- 返回导航链接和状态信息

### 示例 3: 只指定终点

**用户输入：**
```
去杭州西湖
```

**AI 响应：**
- 识别到终点是"杭州西湖"
- 提示用户补充起点信息
- 或建议使用当前位置作为起点

## 高级示例

### 示例 4: 指定地图提供商

**用户输入：**
```
用高德地图从上海到杭州
```

**AI 处理：**
- 识别用户偏好高德地图
- 调用 `navigate_map`，参数：
  ```json
  {
    "start": "上海",
    "end": "杭州",
    "mapProvider": "amap"
  }
  ```
- 打开高德地图网页版

### 示例 5: 复杂的多步骤对话

**对话流程：**

```
用户: 我想去旅游
AI: 请问您想去哪里呢？

用户: 杭州西湖
AI: 好的，请问您的出发地是哪里？

用户: 上海
AI: 好的，我来帮您规划从上海到杭州西湖的路线。
    [调用 navigate_map 工具]
    ✅ 已经打开百度地图，显示从上海到杭州西湖的导航路线。
```

### 示例 6: 多个地点选择

**用户输入：**
```
我想从北京去上海或者杭州，不确定去哪个
```

**AI 响应：**
- 识别两个可能的终点
- 提供两个选项的信息对比
- 等待用户确认后再调用导航工具

## 实际场景示例

### 场景 1: 商务出差

```
用户: 明天要去上海浦东新区开会，从北京出发

AI: 好的，我来帮您查看从北京到上海浦东新区的路线。
    [调用工具]
    ✅ 已打开百度地图导航
    📍 起点：北京
    📍 终点：上海浦东新区
    
    根据地图显示，有以下出行方式供您选择：
    - 高铁：约 4.5-5.5 小时
    - 飞机：约 2-3 小时（不含往返机场时间）
    - 自驾：约 12-14 小时
```

### 场景 2: 旅游规划

```
用户: 周末想去杭州西湖玩，从上海出发

AI: 好的！我来帮您规划从上海到杭州西湖的路线。
    [调用 navigate_map]
    ✅ 地图已打开！
    
    杭州西湖是个不错的周末游玩地点。根据导航：
    - 距离约 170 公里
    - 自驾约 2 小时
    - 也可以选择高铁，约 1 小时到杭州站，然后打车到西湖
    
    需要我帮您查询一下周末的天气情况或者推荐景点吗？
```

### 场景 3: 紧急情况

```
用户: 快帮我找到最近的医院！我在北京朝阳区

AI: 我会立即帮您在地图上定位附近的医院。
    [调用导航工具]
    
    地图已打开，显示您附近的医疗机构。
    建议您：
    1. 拨打 120 急救电话
    2. 根据地图导航前往最近的医院
    3. 如需帮助可以随时告诉我
```

### 场景 4: 机场接送

```
用户: 帮我规划一下从首都机场到北京饭店的路线

AI: 好的，我来帮您查看从首都机场到北京饭店的路线。
    [调用工具]
    ✅ 导航已启动
    
    路线概览：
    - 距离约 26 公里
    - 预计时间：40-60 分钟（取决于交通状况）
    
    出行建议：
    - 出租车：约 80-100 元
    - 机场巴士 + 地铁：更经济实惠
    - 如果行李较多，建议打车直达
```

## 多地图对比示例

### 百度地图 vs 高德地图

**用户输入：**
```
从北京到上海，分别用百度地图和高德地图看看有什么区别
```

**AI 处理：**
```
好的，我先用百度地图查看：
[调用 navigate_map with baidu]

然后用高德地图：
[调用 navigate_map with amap]

两个地图的路线建议略有不同：
- 百度地图推荐：[路线详情]
- 高德地图推荐：[路线详情]

您更倾向于使用哪个地图呢？
```

## 错误处理示例

### 示例 1: 无法识别地点

**用户输入：**
```
从这里到那里
```

**AI 响应：**
```
抱歉，我无法识别"这里"和"那里"具体指哪些地点。
请提供具体的地点名称，例如：
- 城市名：北京、上海
- 具体地标：天安门、东方明珠
- 详细地址：北京市朝阳区xxx路xxx号
```

### 示例 2: 地点名称模糊

**用户输入：**
```
去火车站
```

**AI 响应：**
```
我注意到"火车站"比较模糊，很多城市都有多个火车站。
请问您指的是：
- 北京站
- 北京西站
- 北京南站
- 还是其他城市的火车站？

同时，请告诉我您的出发地点。
```

## 集成其他功能示例

### 与天气查询结合

```
用户: 明天从北京到上海，天气怎么样？

AI: 
1. 先查看路线规划
   [调用 navigate_map]
   
2. 查询两地天气
   明天北京：晴，15-25°C
   明天上海：多云，18-26°C
   
3. 出行建议：
   - 天气适宜出行
   - 建议携带薄外套
   - 注意两地温差
```

### 与日程安排结合

```
用户: 下周三要去杭州开会，帮我安排一下

AI:
1. 路线规划
   [调用 navigate_map: 北京 → 杭州]
   
2. 出行建议：
   - 高铁：6-7 小时
   - 飞机：2-3 小时
   
3. 时间安排建议：
   - 如果上午开会，建议前一天晚上到达
   - 可以预订杭州的酒店
   
需要我帮您查询高铁票或机票吗？
```

## 命令行测试

如果要在命令行测试 MCP 服务器（不使用 Claude Desktop）：

```bash
# 1. 启动服务器
./qwall2-mcp

# 2. 服务器将等待 stdin 输入（JSON-RPC 格式）

# 3. 发送工具调用请求（示例）
# 注意：这需要符合 MCP 协议的 JSON-RPC 格式
```

## 性能测试示例

```bash
# 运行测试
go test -v ./...

# 查看测试覆盖率
go test -cover ./...

# 性能基准测试
go test -bench=. ./...
```

## 调试技巧

### 启用详细日志

在 main.go 中的服务器创建部分已经启用了日志：

```go
s := server.NewMCPServer(
    "map-navigation-mcp",
    "1.0.0",
    server.WithLogging(),  // 启用日志
)
```

### 查看运行日志

运行服务器时，会输出：
```
🚀 MCP 地图导航服务器已启动
📍 支持的地图：百度地图、高德地图
🔧 可用工具：navigate_map, parse_navigation_intent
```

## 总结

这个 MCP 服务器提供了灵活的地图导航功能，可以：

✅ 自然语言理解导航意图  
✅ 支持多个地图提供商  
✅ 自动打开浏览器导航  
✅ 处理各种复杂场景  
✅ 友好的错误提示  

通过与 Claude 等 AI 助手结合，能够提供更智能、更便捷的导航体验！
