# ğŸ—ï¸ qwall2 ç³»ç»Ÿæ¶æ„æ–‡æ¡£

## ç³»ç»Ÿæ¦‚è¿°

qwall2 æ˜¯ä¸€ä¸ªåŸºäº MCPï¼ˆModel Context Protocolï¼‰ç†å¿µçš„ AI åœ°å›¾å¯¼èˆªç³»ç»Ÿï¼Œé€šè¿‡ Go åç«¯å’Œ Web å‰ç«¯å®ç°æ™ºèƒ½å¯¼èˆªåŠŸèƒ½ã€‚

## æ ¸å¿ƒæ¶æ„

### ç³»ç»Ÿå±‚æ¬¡ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·å±‚ (User Layer)                    â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  æ–‡å­—è¾“å…¥     â”‚              â”‚  è¯­éŸ³è¾“å…¥     â”‚          â”‚
â”‚  â”‚  Text Input  â”‚              â”‚ Voice Input  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Web å‰ç«¯ (Web Frontend)                   â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  index.html + CSS + JavaScript                    â”‚    â”‚
â”‚  â”‚  - å½•éŸ³åŠŸèƒ½ (MediaRecorder)                       â”‚    â”‚
â”‚  â”‚  - API è°ƒç”¨ (Fetch)                               â”‚    â”‚
â”‚  â”‚  - ç»“æœå±•ç¤º                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“ HTTP POST /api/navigate
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Go HTTP æœåŠ¡å™¨ (Go Backend)                 â”‚
â”‚                   :8080                                   â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  internal/server/server.go                        â”‚    â”‚
â”‚  â”‚  - è·¯ç”±ç®¡ç†                                       â”‚    â”‚
â”‚  â”‚  - è¯·æ±‚å¤„ç†                                       â”‚    â”‚
â”‚  â”‚  - å“åº”ç”Ÿæˆ                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STT æ¨¡å— (è¯­éŸ³)     â”‚        â”‚   AI å¤„ç†æ¨¡å—         â”‚
â”‚  internal/stt/       â”‚        â”‚  internal/ai/        â”‚
â”‚                      â”‚        â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ OpenAI Whisper â”‚  â”‚        â”‚  â”‚   ChatGPT      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†“ å¤±è´¥       â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚  â”‚    Claude      â”‚  â”‚
â”‚  â”‚  æœ¬åœ°é™çº§       â”‚  â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚ whisper.cpp    â”‚  â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     vosk       â”‚  â”‚        â”‚  â”‚   DeepSeek     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                                  â†“
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  åœ°å›¾ URL ç”Ÿæˆ        â”‚
              â”‚  pkg/mapprovider/    â”‚
              â”‚                      â”‚
              â”‚  - ç™¾åº¦åœ°å›¾          â”‚
              â”‚  - é«˜å¾·åœ°å›¾          â”‚
              â”‚  - Google Maps      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                   è¿”å› URL ç»™å‰ç«¯
                          â†“
                   å‰ç«¯è·³è½¬åˆ°åœ°å›¾
```

## æ¨¡å—è¯¦è§£

### 1. Web å‰ç«¯æ¨¡å—

**ä½ç½®**ï¼š`web/`

**ç»„ä»¶**ï¼š
- `index.html`ï¼šä¸»é¡µé¢ç»“æ„
- `static/css/style.css`ï¼šæ ·å¼å®šä¹‰
- `static/js/app.js`ï¼šäº¤äº’é€»è¾‘

**åŠŸèƒ½**ï¼š
- ğŸ“ æ–‡å­—è¾“å…¥å¤„ç†
- ğŸ¤ è¯­éŸ³å½•åˆ¶ï¼ˆWebRTC MediaRecorderï¼‰
- ğŸ”„ API è¯·æ±‚å‘é€ï¼ˆFetch APIï¼‰
- ğŸ“Š ç»“æœå±•ç¤º
- ğŸ¨ å“åº”å¼ UI

**æŠ€æœ¯æ ˆ**ï¼š
- HTML5
- CSS3ï¼ˆæ¸å˜ã€é˜´å½±ã€åŠ¨ç”»ï¼‰
- JavaScriptï¼ˆåŸç”Ÿï¼Œæ— æ¡†æ¶ï¼‰
- WebRTC API

### 2. HTTP æœåŠ¡å™¨æ¨¡å—

**ä½ç½®**ï¼š`internal/server/server.go`

**èŒè´£**ï¼š
- ğŸŒ HTTP æœåŠ¡å™¨ç®¡ç†
- ğŸ”€ è·¯ç”±åˆ†å‘
- ğŸ“¥ è¯·æ±‚è§£æ
- ğŸ“¤ å“åº”ç”Ÿæˆ
- ğŸ”„ CORS å¤„ç†

**API ç«¯ç‚¹**ï¼š

```go
GET  /                   // ä¸»é¡µ
GET  /static/*          // é™æ€æ–‡ä»¶
POST /api/navigate      // å¯¼èˆªè¯·æ±‚
GET  /api/health        // å¥åº·æ£€æŸ¥
```

**æ ¸å¿ƒæµç¨‹**ï¼š

```go
handleNavigate(request) {
    1. è§£æè¯·æ±‚ï¼ˆæ–‡å­— or è¯­éŸ³ï¼‰
    2. if (è¯­éŸ³) â†’ STT è½¬å½•
    3. AI æå–æ„å›¾ (èµ·ç‚¹/ç»ˆç‚¹)
    4. ç”Ÿæˆåœ°å›¾ URL
    5. è¿”å›å“åº”
}
```

### 3. STT æ¨¡å—ï¼ˆè¯­éŸ³è½¬æ–‡å­—ï¼‰

**ä½ç½®**ï¼š`internal/stt/`

**æ–‡ä»¶ç»“æ„**ï¼š
- `stt.go`ï¼šæ¥å£å®šä¹‰ã€è‡ªåŠ¨é™çº§å®¢æˆ·ç«¯
- `openai.go`ï¼šOpenAI Whisper å®ç°
- `local.go`ï¼šæœ¬åœ°é™çº§å®ç°

**é™çº§ç­–ç•¥**ï¼š

```
OpenAI Whisper (ä¼˜å…ˆ)
    â†“ å¤±è´¥
whisper.cpp (æœ¬åœ°æ¨¡å‹)
    â†“ å¤±è´¥
vosk (è½»é‡çº§è¯†åˆ«)
    â†“ å¤±è´¥
ç®€å•æç¤º "[è¯­éŸ³è¯†åˆ«å¤±è´¥ï¼Œè¯·ä½¿ç”¨æ–‡å­—è¾“å…¥]"
```

**æ¥å£è®¾è®¡**ï¼š

```go
type Client interface {
    TranscribeAudio(ctx, audio, format) (*Result, error)
    GetProviderName() string
}

type Result struct {
    Text     string   // è½¬æ¢çš„æ–‡å­—
    Language string   // è¯†åˆ«çš„è¯­è¨€
    Provider Provider // ä½¿ç”¨çš„æä¾›å•†
}
```

### 4. AI å¤„ç†æ¨¡å—

**ä½ç½®**ï¼š`internal/ai/`

**æ–‡ä»¶ç»“æ„**ï¼š
- `ai.go`ï¼šæ¥å£å®šä¹‰ã€å·¥å‚æ–¹æ³•
- `chatgpt.go`ï¼šChatGPT å®ç°
- `claude.go`ï¼šClaude å®ç°
- `deepseek.go`ï¼šDeepSeek å®ç°

**ç»Ÿä¸€æ¥å£**ï¼š

```go
type Client interface {
    ExtractNavigationIntent(ctx, text) (*NavigationIntent, error)
    GetProviderName() string
}

type NavigationIntent struct {
    Start string `json:"start"` // èµ·ç‚¹
    End   string `json:"end"`   // ç»ˆç‚¹
}
```

**AI æç¤ºè¯ç­–ç•¥**ï¼š

æ‰€æœ‰ AI å®¢æˆ·ç«¯ä½¿ç”¨ç»Ÿä¸€çš„æç¤ºè¯æ¨¡æ¿ï¼š

```
ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½å¯¼èˆªåŠ©æ‰‹ã€‚ç”¨æˆ·ä¼šè¯´å‡ºå¯¼èˆªéœ€æ±‚ï¼Œä½ éœ€è¦æå–èµ·ç‚¹å’Œç»ˆç‚¹ã€‚
è¯·ä»¥ JSON æ ¼å¼è¿”å›ç»“æœï¼š{"start": "èµ·ç‚¹", "end": "ç»ˆç‚¹"}

è§„åˆ™ï¼š
1. å¦‚æœç”¨æˆ·åªè¯´äº†ç›®çš„åœ°ï¼Œèµ·ç‚¹è®¾ä¸º"å½“å‰ä½ç½®"
2. æå–å…·ä½“çš„åœ°å€ã€åœ°ç‚¹åç§°
3. åªè¿”å› JSONï¼Œä¸è¦å…¶ä»–æ–‡å­—
```

**æ”¯æŒçš„æ¨¡å‹**ï¼š

| æä¾›å•† | æ¨¡å‹ | ç‰¹ç‚¹ |
|--------|------|------|
| ChatGPT | gpt-3.5-turbo | å¿«é€Ÿã€ç»æµ |
| Claude | claude-3-5-sonnet | æ™ºèƒ½ã€å‡†ç¡® |
| DeepSeek | deepseek-chat | ä¸­æ–‡ä¼˜åŒ– |

### 5. é…ç½®ç®¡ç†æ¨¡å—

**ä½ç½®**ï¼š`internal/config/config.go`

**é…ç½®æ–‡ä»¶**ï¼š`config.yaml`

**åŠŸèƒ½**ï¼š
- ğŸ“„ YAML é…ç½®åŠ è½½
- ğŸ” ç¯å¢ƒå˜é‡æ›¿æ¢
- âš™ï¸ é»˜è®¤å€¼æä¾›

**é…ç½®ç»“æ„**ï¼š

```yaml
server:        # HTTP æœåŠ¡å™¨é…ç½®
stt:           # STT é…ç½®
ai:            # AI é…ç½®ï¼ˆå¤šæä¾›å•†ï¼‰
map:           # åœ°å›¾é…ç½®
```

**ç¯å¢ƒå˜é‡æ”¯æŒ**ï¼š

```yaml
openai_key: "${OPENAI_API_KEY}"  # ä»ç¯å¢ƒå˜é‡è¯»å–
```

### 6. åœ°å›¾æœåŠ¡æ¨¡å—

**ä½ç½®**ï¼š`pkg/mapprovider/mapprovider.go`

**æ”¯æŒçš„åœ°å›¾**ï¼š

1. **ç™¾åº¦åœ°å›¾**
   - URL: `https://map.baidu.com/`
   - å‚æ•°: `origin=èµ·ç‚¹&destination=ç»ˆç‚¹&mode=driving`

2. **é«˜å¾·åœ°å›¾**
   - URL: `https://uri.amap.com/navigation`
   - å‚æ•°: `from=èµ·ç‚¹&to=ç»ˆç‚¹`

3. **Google Maps**
   - URL: `https://www.google.com/maps/dir/`
   - å‚æ•°: `èµ·ç‚¹/ç»ˆç‚¹`

**å‡½æ•°æ¥å£**ï¼š

```go
GenerateMapURL(provider, start, end string) (string, error)
GenerateBaiduMapURL(start, end string) string
GenerateAmapURL(start, end string) string
GenerateGoogleMapsURL(start, end string) string
```

## æ•°æ®æµè¯¦è§£

### æ–‡å­—è¾“å…¥æµç¨‹

```
1. ç”¨æˆ·åœ¨è¾“å…¥æ¡†è¾“å…¥ï¼š"ä»åŒ—äº¬å»ä¸Šæµ·"
   â†“
2. å‰ç«¯éªŒè¯è¾“å…¥éç©º
   â†“
3. æ„å»ºè¯·æ±‚ï¼š
   {
     "type": "text",
     "input": "ä»åŒ—äº¬å»ä¸Šæµ·",
     "ai_provider": "chatgpt",
     "map_provider": "baidu"
   }
   â†“
4. POST /api/navigate
   â†“
5. æœåŠ¡å™¨è§£æè¯·æ±‚
   â†“
6. è°ƒç”¨ ChatGPT å®¢æˆ·ç«¯ï¼š
   ExtractNavigationIntent("ä»åŒ—äº¬å»ä¸Šæµ·")
   â†“
7. ChatGPT è¿”å›ï¼š
   {
     "start": "åŒ—äº¬",
     "end": "ä¸Šæµ·"
   }
   â†“
8. ç”Ÿæˆç™¾åº¦åœ°å›¾ URLï¼š
   "https://map.baidu.com/?origin=åŒ—äº¬&destination=ä¸Šæµ·&mode=driving"
   â†“
9. è¿”å›å“åº”ï¼š
   {
     "success": true,
     "url": "...",
     "start": "åŒ—äº¬",
     "end": "ä¸Šæµ·"
   }
   â†“
10. å‰ç«¯æ¥æ”¶å“åº”ï¼Œè·³è½¬åˆ°åœ°å›¾
```

### è¯­éŸ³è¾“å…¥æµç¨‹

```
1. ç”¨æˆ·ç‚¹å‡»"å¼€å§‹å½•éŸ³"
   â†“
2. æµè§ˆå™¨è¯·æ±‚éº¦å…‹é£æƒé™
   â†“
3. MediaRecorder å¼€å§‹å½•åˆ¶
   â†“
4. ç”¨æˆ·è¯´è¯ï¼š"ä»è¥¿æ¹–åˆ°çµéšå¯º"
   â†“
5. ç”¨æˆ·ç‚¹å‡»"åœæ­¢å½•éŸ³"
   â†“
6. MediaRecorder åœæ­¢ï¼Œä¿å­˜ä¸º Blob
   â†“
7. å‰ç«¯è½¬æ¢ä¸º Base64
   â†“
8. æ„å»ºè¯·æ±‚ï¼š
   {
     "type": "audio",
     "audio": "base64_data...",
     "format": "webm",
     "ai_provider": "chatgpt",
     "map_provider": "baidu"
   }
   â†“
9. POST /api/navigate
   â†“
10. æœåŠ¡å™¨è§£ç  Base64 â†’ éŸ³é¢‘æ•°æ®
    â†“
11. è°ƒç”¨ STT å®¢æˆ·ç«¯ï¼ˆOpenAI Whisperï¼‰ï¼š
    TranscribeAudio(audio, "webm")
    â†“
12. Whisper è¿”å›ï¼š
    {
      "text": "ä»è¥¿æ¹–åˆ°çµéšå¯º",
      "language": "zh"
    }
    â†“
13. è°ƒç”¨ AI å®¢æˆ·ç«¯ï¼š
    ExtractNavigationIntent("ä»è¥¿æ¹–åˆ°çµéšå¯º")
    â†“
14. AI è¿”å›ï¼š
    {
      "start": "è¥¿æ¹–",
      "end": "çµéšå¯º"
    }
    â†“
15. ç”Ÿæˆåœ°å›¾ URL
    â†“
16. è¿”å›å“åº”ï¼ˆåŒ…å«è¯†åˆ«çš„æ–‡å­—ï¼‰
    â†“
17. å‰ç«¯å±•ç¤ºè¯†åˆ«ç»“æœï¼Œç„¶åè·³è½¬
```

## é”™è¯¯å¤„ç†æœºåˆ¶

### 1. STT é™çº§

```go
AutoClient.TranscribeAudio() {
    // å°è¯• OpenAI Whisper
    result, err := primaryClient.TranscribeAudio()
    if err == nil {
        return result  // æˆåŠŸ
    }
    
    // é™çº§åˆ°æœ¬åœ°
    if enableFallback {
        return fallbackClient.TranscribeAudio()
    }
    
    return error
}
```

### 2. AI è°ƒç”¨å¤±è´¥

```go
// è¿”å›è¯¦ç»†é”™è¯¯ä¿¡æ¯
{
  "success": false,
  "error": "AI å¤„ç†å¤±è´¥: API key æ— æ•ˆ",
  "error_type": "ai_error"
}
```

### 3. ç½‘ç»œé”™è¯¯

```go
// è®¾ç½®è¶…æ—¶
ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
defer cancel()
```

## å®‰å…¨æ€§è€ƒè™‘

### 1. API Key ç®¡ç†

- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨
- âœ… ä¸åœ¨ä»£ç ä¸­ç¡¬ç¼–ç 
- âœ… ä¸æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶

### 2. è¾“å…¥éªŒè¯

```go
// éªŒè¯éŸ³é¢‘å¤§å°
if len(audioData) > 10*1024*1024 {  // 10MB
    return error("éŸ³é¢‘æ–‡ä»¶è¿‡å¤§")
}

// éªŒè¯æ–‡å­—é•¿åº¦
if len(text) > 1000 {
    return error("æ–‡å­—è¾“å…¥è¿‡é•¿")
}
```

### 3. CORS é…ç½®

```go
w.Header().Set("Access-Control-Allow-Origin", "*")
w.Header().Set("Access-Control-Allow-Methods", "GET, POST, OPTIONS")
w.Header().Set("Access-Control-Allow-Headers", "Content-Type")
```

## æ€§èƒ½ä¼˜åŒ–

### 1. HTTP å®¢æˆ·ç«¯å¤ç”¨

```go
type ChatGPTClient struct {
    client *http.Client  // å¤ç”¨è¿æ¥
}
```

### 2. ä¸Šä¸‹æ–‡è¶…æ—¶

```go
ctx, cancel := context.WithTimeout(ctx, 30*time.Second)
defer cancel()
```

### 3. é™çº§ç­–ç•¥

- STT å¤±è´¥ â†’ æœ¬åœ°å¤„ç†
- å‡å°‘ API è°ƒç”¨æˆæœ¬

## å¯æ‰©å±•æ€§

### 1. æ·»åŠ æ–° AI æä¾›å•†

```go
// 1. åˆ›å»º internal/ai/newai.go
type NewAIClient struct { ... }

func (c *NewAIClient) ExtractNavigationIntent() { ... }

// 2. åœ¨ ai.go ä¸­æ³¨å†Œ
case ProviderNewAI:
    return NewNewAIClient(config)
```

### 2. æ·»åŠ æ–°åœ°å›¾æœåŠ¡

```go
// åœ¨ mapprovider.go ä¸­æ·»åŠ 
func GenerateNewMapURL(start, end string) string {
    // å®ç° URL ç”Ÿæˆé€»è¾‘
}
```

### 3. æ·»åŠ æ–° STT æä¾›å•†

```go
// åˆ›å»º internal/stt/newstt.go
type NewSTTClient struct { ... }

func (c *NewSTTClient) TranscribeAudio() { ... }
```

## éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ

```
localhost:8080
â”œâ”€â”€ Go æœåŠ¡å™¨
â”œâ”€â”€ é™æ€æ–‡ä»¶ï¼ˆweb/ï¼‰
â””â”€â”€ API ç«¯ç‚¹
```

### ç”Ÿäº§ç¯å¢ƒå»ºè®®

```
                   Internet
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Nginx (443)  â”‚  HTTPS
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  qwall2 (8080)â”‚  HTTP
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â†“                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI APIs   â”‚              â”‚   STT API   â”‚
â”‚ ChatGPT     â”‚              â”‚  Whisper    â”‚
â”‚ Claude      â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ DeepSeek    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯æ ˆæ€»ç»“

### åç«¯
- **è¯­è¨€**ï¼šGo 1.23.0
- **HTTP**ï¼šnet/httpï¼ˆæ ‡å‡†åº“ï¼‰
- **é…ç½®**ï¼šgopkg.in/yaml.v3
- **ä¾èµ–**ï¼šminimalï¼ˆä»… YAMLï¼‰

### å‰ç«¯
- **HTML5**ï¼šç»“æ„
- **CSS3**ï¼šæ ·å¼
- **JavaScript**ï¼šåŸç”Ÿï¼ˆæ— æ¡†æ¶ï¼‰
- **API**ï¼šWebRTC MediaRecorderã€Fetch

### å¤–éƒ¨æœåŠ¡
- **AI**ï¼šOpenAIã€Anthropicã€DeepSeek
- **STT**ï¼šOpenAI Whisper
- **åœ°å›¾**ï¼šç™¾åº¦ã€é«˜å¾·ã€Google

## æ€»ç»“

qwall2 ç³»ç»Ÿé‡‡ç”¨äº†æ¨¡å—åŒ–ã€å¯æ‰©å±•çš„æ¶æ„è®¾è®¡ï¼š

1. âœ… **æ¸…æ™°çš„å±‚æ¬¡ç»“æ„**ï¼šå‰ç«¯ â†’ åç«¯ â†’ æœåŠ¡å±‚
2. âœ… **ç»Ÿä¸€çš„æ¥å£è®¾è®¡**ï¼šAIã€STT éƒ½æœ‰ç»Ÿä¸€æ¥å£
3. âœ… **æ™ºèƒ½çš„é™çº§æœºåˆ¶**ï¼šä¿è¯ç³»ç»Ÿå¯ç”¨æ€§
4. âœ… **çµæ´»çš„é…ç½®ç®¡ç†**ï¼šæ”¯æŒå¤šç¯å¢ƒéƒ¨ç½²
5. âœ… **è‰¯å¥½çš„é”™è¯¯å¤„ç†**ï¼šè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
6. âœ… **é«˜å¯æ‰©å±•æ€§**ï¼šæ˜“äºæ·»åŠ æ–°åŠŸèƒ½

ç³»ç»Ÿå·²ç»å®Œå…¨å®ç°å¹¶å¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼ğŸš€
